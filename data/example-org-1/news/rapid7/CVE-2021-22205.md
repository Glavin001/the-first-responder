# CVE-2021-22205: Critical GitLab Vulnerability

On April 14, 2021, GitLab released a security update to address a critical remote code execution vulnerability (CVE-2021-22205) in the web interface.

## Overview
- **Vulnerability ID**: CVE-2021-22205
- **Initial CVSSv3 Score**: 9.9 (revised to 10.0 on September 21, 2021)
- **Affected Versions**: All versions from 11.9 of GitLab Enterprise Edition (EE) and GitLab Community Edition (CE)
- **Patched Versions**:
  - 13.10.3
  - 13.9.6
  - 13.8.8
- **Description**: An authenticated issue due to ExifTool's mishandling of DjVu files, later identified as an unauthenticated vulnerability.

## Impact
- **Change in Vulnerability Status**: From authenticated to unauthenticated, significantly increasing risk implications.
- **Exploitation in the Wild**: Reported since around June or July 2021.
- **Increase in Exploitation Risk**: Expected to rise as the unauthenticated nature of the vulnerability becomes more known.

## Analysis of GitLab Instances (as of October 31, 2021)
- **Total Internet-Facing Installations**: Approximately 60,000
- **Patch Status**:
  - 21% fully patched
  - 50% not patched
  - 29% uncertain (may or may not be vulnerable)

## Mitigation Guidance
- **Primary Action**: Upgrade to the latest version of GitLab.
- **Recommended**: Avoid exposing GitLab to the internet directly; use VPN for remote access.
- **Additional Resources**: Rapid7â€™s AttackerKB contains a full technical analysis and methods to identify vulnerable versions.

## Rapid7 Customers
- **Current Action**: Evaluation for adding a vulnerability check for CVE-2021-22205.
