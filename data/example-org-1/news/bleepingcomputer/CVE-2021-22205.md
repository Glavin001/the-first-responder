# Critical Unpatched GitLab Flaw: CVE-2021-22205

A critical, unauthenticated remote code execution flaw in GitLab, fixed on April 14, 2021, remains widely unpatched, with over 50% of deployments vulnerable.

## Vulnerability Details
- **CVE ID**: CVE-2021-22205
- **CVSS v3 Score**: 10.0
- **Impact**: Allows unauthenticated, remote attackers to execute arbitrary commands as the 'git' user (repository admin), giving full access to the repository.

## Exploitation in the Wild
- **Start**: June 2021
- **Method**: Exploiting internet-facing GitLab servers to create new users with admin rights.
- **Exploit Tool**: Published on GitHub on June 4, 2021, targeting the vulnerable ExifTool component.
- **Access Requirements**: No authentication, CSRF token, or valid HTTP endpoint required.

## Research Findings by Rapid7
- **Scope**: 60,000 internet-facing GitLab installations analyzed.
- **Unpatched Systems**: At least 50% remain unpatched against this critical RCE flaw.
- **Uncertain Status**: 29% of the servers could not be conclusively analyzed due to inaccessible version strings.

## Patching Information
- **Vulnerable Versions**: All versions from 11.9 up to but not including:
  - 13.10.3
  - 13.9.6
  - 13.8.8
- **Affected Editions**: Both GitLab Enterprise Edition (EE) and GitLab Community Edition (CE).
- **Update Guidance**: For detailed update instructions, visit the [GitLab update portal](https://about.gitlab.com/update/).

## Verifying Patch Application
- **Test Method**: Send POST requests to exploit ExifTool's image file handling.
- **Expected Response**: Patched versions should reject the exploit attempt with an HTTP 404 error.
